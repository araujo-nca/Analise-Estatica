  
BARTIPO = [   
   12  1 1
   16  1 1
   18  2 1
   20  1 1
   21  1 1
   22  1 1
   35  1 1
   48  1 1
   86  0 1    
  100  0 1    
  101  0 1    
  102  0 1    
  103  0 1    
  104  0 1    
  106  0 1    
  120  0 1    
  122  0 1    
  123  0 1    
  126  0 1    
  131  0 1    
  134  0 1    
  136  0 1   
  138  0 1    
  140  0 1    
  210  0 1    
  213  0 1   
  216  0 1    
  217  0 1    
  218  0 1    
  219  0 1    
  220  0 1   
  225  0 1   
  228  0 1   
  231  0 1   
  233  0 1   
  234  0 1   
  300  1 1  
  301  1 1  
  302  1 1  
  303  1 1  
  305  1 1  
  320  0 1   
  325  0 1   
  326  0 1   
  360  0 1   
  370  0 1   
  396  0 1   
  500  1 1  
  535  0 1   
  536  0 1   
  800  1 1  
  808  1 1  
  810  1 1  
  814  0 1   
  824  0 1   
  834  0 1    
  839  0 1   
  840  0 1    
  848  0 1    
  856  0 1   
  895  0 1   
  896  0 1   
  897  0 1   
  898  0 1   
  904  1 1  
  915  1 1  
  919  1 1  
  925  1 1  
  933  0 1   
  934  0 1   
  938  0 1   
  939  0 1   
  955  0 1   
  959  0 1   
  960  0 1   
  964  0 1   
  965  0 1   
  976  0 1   
  995  0 1   
 1015  0 1    
 1030  0 1   
 1047  0 1   
 1060  0 1   
 1210  0 1   
 1503  0 1   
 1504  0 1   
 2458  0 1   
 4501  0 1   
 4521  0 1   
 4522  0 1   
 4523  1 1  
 4530  1 1  
 4532  0 1   
 4533  0 1   
 4542  0 1   
 4552  0 1   
 4562  0 1   
 4572  0 1   
 4582  0 1   
 4592  0 1   
 4596  1 1  
 4623  0 1   
 4703  0 1   
 4804  1 1  
 4805  0 1   
 4807  0 1   
 4862  0 1
 
 ];
 
 for i = 1:size(BARTIPO,1)
     
     NOEXT(i)   = BARTIPO(i,1);     
     NOE        = NOEXT(i);
     NOINT(NOE) = i;
     DBAR(i,1) = i;
     
     if (BARTIPO(i,2) == 2)
         
         DBAR(i,2) = 3;
         
     elseif (BARTIPO(i,2) == 0)
         
         DBAR(i,2) = 1;
         
     elseif (BARTIPO(i,2) == 1)
         
         DBAR(i,2) = 2;
         
     end
     
     DBAR(i,3) = BARTIPO(i,3);
     
 end
 
 Tensaoangulo = [
    
  1000 -24. 
  1000 -26. 
  1020 -24.
  1010 -22. 
  1000 -62. 
  1000 -20. 
  1000 -27. 
  1000 -42.   
  1033 -42.                           
  1056 -28.                                           
  1069 -36.                                    
  1059 -43.                                    
  1072 -43.                                           
  1061 -51.                           
  1050 -52.                                    
  1041 -41.                           
  1067 -41.                           
  1035 -46.                           
  1037 -43.                           
  1027 -27.                                           
  1027 -26.                                           
  1028 -33.                           
  1036 -44.                            
  1023 -53.                           
  1048 -27.                                           
  1050 -29.                            
  1049 -28.                            
  1050 -32.                           
  1025 -40.                          
  1028 -39.                                           
  1052 -32.                                           
  1000 -34.                                           
  1016 -40.                            
  1010 -49.                          
  1039 -36.                                          
  1027 -39.                          
  1020 -19. 
  1010 -19. 
  1020 -18. 
  1020 -24. 
  1000 -22. 
  1049 -24.                                           
  1046 -23.                                           
  1033 -26.                           
  1046 -22.                                           
  1049 -25.                                          
  1041 -26.                                           
  1020 -21. 
  1035 -26.                                           
  1023 -29.                           
  1020 -6.9 
  1020 3.73 
  1020 -3.8 
  1000 -37.                          
  1038 -17.                                          
   991 -29.                           
   999 -6.2                                          
   986 -9.2                           
   999 -5.3                            
  1035 -11.                                          
  1044 -35.                                          
  1028 -4.1                                           
  1039 -2.8                                           
  1012 -1.9                                           
  1020 -15. 
  1020 -13. 
  1000 5.98 
  1020 .11 
  1038 -18.                                          
  1000 -18.                           
  1043 -37.                                           
  1000 -40.                          
  1058 -23.                                          
  1033 -35.                                     
  1000 -37.                          
  1037 -31.                                           
  1000 -33.                          
  1012 -33.                                           
  1050 -19.                                           
   998 -39.                            
  1052 -20.                                           
  1017 -.92                                           
  1043 -7.8                                           
  1000 -36.                         
  1061 -49.                                           
  1026 -53.                           
  1000 -6.4                           
  1026 -61.                           
  1034 -66.                                           
  1032 -68.                                     
  1010 -60.  
  1020 -73.   
  1041 -73.                                           
  1014 -73.                           
  1025 -72.                                           
  1007 -80.                           
  1012 -88.                           
  1009 -85.                            
  1018 -91.                           
  1018 -67.                                           
  1000 -68. 
  1018 -71.                          
  1003 -74.                          
  1000 -75.  
  1025 -78.                                           
  1025 -80.                          
  1046 -78.                                     
 
 ];

DBAR(:,4) = Tensaoangulo(:,1)/1000;
DBAR(:,5) = (Tensaoangulo(:,2)*pi)/(180);

PgeradoQgerado = [
   300. -203. -540. 420.   0    0      0          
   800. -134. -720. 480.   0    0      0          
  995.8 -400. -546. 600.   0    0      0          
   900. -321. -640. 640.   0    0      0          
   140. -22.1 -80.  84.    0    0      0         
   150. -20.6 -120. 126.   0    0      0          
   200. -49.6 -180. 180.   0    0      0          
   0.   -461. -1080 1200.  0    0      0           
   0      0      0     0   66.  1.2    0  
   0      0      0     0   0    0      0              
   0      0      0     0   0    0    -200.  
   0      0      0     0   0    0    -100.  
   0      0      0     0   0    0      0            
   0      0      0     0  910. 235.    0   
   0      0      0     0   0    0    -100.  
   0      0      0     0  180.  90.    0   
   0      0      0     0  200.  38.    0   
   0      0      0     0  450. 175.    0   
   0      0      0     0  290.  95.    0   
   0      0      0     0   0    0      0            
   0      0      0     0   0    0      0           
   0      0      0     0  54.  23.     0  
   0      0      0     0  72.  34.     0  
   0      0      0     0  700. 250.    0   
   0      0      0     0   0    0      0            
   0      0      0     0  93.  39.     0  
   0      0      0     0  53.  25.     0  
   0      0      0     0  364. 58.     0  
   0      0      0     0  600. 200.    0   
   0      0      0     0   0    0      0
   0      0      0     0   0    0      0    
   0      0      0     0   0    0      0  
   0      0      0     0  86.  34.     0  
   0      0      0     0  89.7 31.9    0   
   0      0      0     0   0    0      0         
   0      0      0     0 1000. 350.    0   
  700.  -184.  -440.  392. 0    0      0           
  300.  -128.  -140.  140. 0    0      0            
  400.  -125.  -150.  150. 0    0      0            
  200.  -279.  -600.  600. 0    0      0            
  300.  -60.4  -120.  120. 0    0      0            
   0      0      0     0   0    0      0
   0      0      0     0   0    0      0       
   0      0      0     0  274. 104.    0   
   0      0      0     0   0    0      0         
   0      0      0     0   0    0      0       
   0      0      0     0   0    0      0        
  800.  -118.  -540.  540. 0    0      0            
   0      0      0     0   0    0      0       
   0      0      0     0  700. 150.    0   
  1100.  138.4 -800.  800. 0    0      0            
  1150.  114.4 -600.  600. 0    0      0            
  1200. -72.2  -400.  532. 0    0      0            
   0      0      0     0  735.4 191.   0    
   0      0      0     0   0    0      0        
   0      0      0     0  13.4  4.2    0   
   0      0      0     0   0    0      0   
   0      0      0     0  159.  36.    0   
   0      0      0     0  94.   18.    0   
   0      0      0     0   0     0     0
   0      0      0     0   0     0     0
   0      0      0     0   0     0     0          
   0      0      0     0   0     0     0            
   0      0      0     0   0     0     0         
  700.   -236.  -475. 475. 0     0     0            
  700.   -109.  -516. 465. 0     0     0            
  700.   89.06  -148. 220. 0     0     0            
  950.   73.05  -440. 420. 0     0     0            
   0      0      0     0   0     0     0            
   0      0      0     0  237.  59.    0   
   0      0      0     0   0     0     0            
   0      0      0     0  1149. 53.06  0     
   0      0      0     0   0     0     0           
   0      0      0     0   0     0    100.  
   0      0      0     0  844.7 469.1  0     
   0      0      0     0   0     0     0           
   0      0      0     0  755.6 56.24  0     
   0      0      0     0   0     0     0            
   0      0      0     0   0     0     0            
   0      0      0     0  70.    2.    0   
   0      0      0     0   0     0     0          
   0      0      0     0   0     0     0           
   0      0      0     0   0     0     0           
   0      0      0     0  1228. 425.   0    
   0      0      0     0   0     0     0           
   0      0      0     0   145.  63.   0    
   0      0      0     0   403. 126.   0    
   0      0      0     0   31.4 7.1   -45.  
   0      0      0     0   0     0     0          
   0      0      0     0   0     0    -20.  
  50.   -9.08   -42.  30.  0     0     0           
   0.     0    -54.5 63.96 0     0     0             
   0      0      0     0   0     0     0           
   0      0      0     0  75.4 16.1    0   
   0      0      0     0   0     0     0          
   0      0      0     0  12.6  1.2   -20.  
   0      0      0     0  23.8  7.4    0   
   0      0      0     0  18.   6.4    0   
   0      0      0     0  65.5 16.7    30.  
   0      0      0     0   0     0     0           
  230.  -28.7  -160. 160.  0     0     0           
   0      0      0     0  128.2 40.76  0     
   0      0      0     0  182.1 29.75  0     
  50.   -16.8  -86.   59.  0      0    0           
   0      0      0     0   0      0    0          
   0      0      0     0  128.9 36.3   0    
   0      0      0     0   0      0   -30.  
];

DBAR(:,6) = PgeradoQgerado(:,1);
DBAR(:,7) = PgeradoQgerado(:,2);
DBAR(:,8) = PgeradoQgerado(:,3);
DBAR(:,9) = PgeradoQgerado(:,4);

for i = 1:size(PgeradoQgerado,1)
    
    if (PgeradoQgerado(i,3) == 0)
        
        DBAR(i,8) = -999.9;
        
    end
    
    if (PgeradoQgerado(i,4) == 0)
        
        DBAR(i,9) = 9999.9;
        
    end
    
end

DBAR(:,10) = PgeradoQgerado(:,5);
DBAR(:,11) = PgeradoQgerado(:,6);
% DBAR(:,12) = PgeradoQgerado(:,7);
DBAR(:,12) = PgeradoQgerado(:,7) / 100;
% DBAR(:,8) = -99999999999999.9;
% DBAR(:,9) = 999999999999999.9;

PB = 100;

DLIN = [
   86        48        0      .71475              0                 1.                     
   86       122        0       1.913              0                 1.                      
   86       122        0       1.913              0                 1.                      
  100        20        0       1.264              0                 1.                     
  100       101      .172      2.72             231.4               1                      
  100       101      .171      2.7              230.2               1                      
  100       210      .209     2.935             254.6               1                      
  100       213        0       2.357              0                 1.                      
  100       535      .153      2.4              203.8               1           
  101       102      .156      2.46             208.5               1          
  101       103      .152      2.39             202.6               1           
  102       120        0        2.403             0                 1.                      
  102      1503       .11      1.91             161.85              1            
  103       123        0        2.419             0                 1.                      
  104       103      .196       3.1             264.9               1           
  104      1503       .05       .82             69.36               1           
  106       104      .152       2.39             202.7              1            
  106       104      .152       2.39             203.1              1            
  106       140        0         2.923            0                 1.                      
  106       140        0         2.668            0                 1.                      
  122       103      .105       1.619           136.35              1            
  123       120      .359       3.945            66.68              1             
  126        86      .109       1.826             51.18             1             
  126        86      .109       1.824            51.18              1            
  126       120        .6        5.95            92.8               1            
  126       120      .606        6.02             93.8              1             
  131        22        0         8.8333            0                1.                      
  134        12        0         1.335             0               .999                     
  134       131      .092       1.01              16.9              1             
  134       396       .32       3.509            59.24              1             
  136        16        0         1.536             0                1.                     
  136       120      .436        4.3              66.6              1             
  136       120      .436        4.3              66.6              1             
  136       131      .348        3.42             52.8              1             
  136       134      .375        4.13             69.9              1             
  136       138      .649        6.46             100.8             1              
  136       138      .558        6.19             105.7             1              
  140       138      .652         6.5             101.4             1              
  140       138      .558         6.19            105.7             1              
  210        18        0         .66667            0                1.                     
  210       217        0          1.72             0                1.                      
  210       217        0          1.72             0                1.                      
  210       370      .147        2.32              196.6            1              
  213       216      .219        2.42               40.7            1               
  216       396      .129        1.414              23.77           1                
  217       216      .565        6.248              106.73          1                 
  217       218      .507        5.61                95.6           1                
  217       218      .507        5.61                95.6           1                
  218       234       .43        4.799               82.2           1                
  218       234       .43        4.799               82.2           1                
  219       234      .035        .433                7.34           1                
  219       234      .035        .433                7.34           1                
  220        35        0         4.4965              0            1.025                      
  220       217      .226        2.396              43.235          1                 
  220       219      .726        7.704              138.01          1                 
  225       217        0          2.721               0            .955         
  225       217        0          2.938               0            .955        
  225       231       4.1         19.76               36.08         1                 
  225       231      1.27         13.62               49.47         1                 
  228       219        0           3.595               0            1.                      
  231      4501      4.51         21.69               40.25         1                  
  231      4501      1.49         16.09               55.4          1                 
  233       210       .28         3.99                355.36        1                  
  233       320       .27         3.87                344.03        1                  
  234       233        0           1.113               0            1.                     
  234       233        0             1.                0            1.                     
  320       210      .125         1.937               149.96        1                  
  320       300        0            1.3567             0            1.                     
  320       360      .082          1.256              98.99         1                 
  325       301        0            2.6325             0            1.                      
  325       326        0            2.16               0            1.                      
  325       326        0            2.16               0            1.                      
  325       360        .1         1.519               119.67        1                  
  325       370       .28           4.84               419.5        1                  
  326       134       .07            .76              12.287        1                   
  326       396       .24           2.74               45.47        1                   
  360       302        0            1.9367              0           1.                      
  370       303        0            1.0575              0           1.                     
  370       535     .0931          1.3758               112.3       1                   
  396       305        0              2.2               0         1.025                      
  535       500        0             1.025              0           1.                     
  536       535        0             1.533              0           1.                      
  536       535        0              1.42              0           1.                      
  814       895      .032           1.146               0         .9652          
  814       895       .031           .1651              0         .9652          
  824       800        0               1.68             0         1.024                     
  824       933       .01              .124             15.204      1                   
  824       933       .01              .126             15.428      1                    
  834       934     2.444              12.652           21.706      1                     
  839       840        0                6.64             0          1.                      
  839       840        0                6.29             0          1.                      
  839       898      1.13              6.99             12.617      1                     
  839      1047      1.22              7.69              13.81      1                     
  839      2458       .22              1.09              1.8601     1                      
  839      2458       .17              1.03              2.0537     1                      
  856       810        0                1.05              0         1.                     
  856       933      .052              .654              80.493     1                       
  856      1060      .056              .697              85.746     1                     
  895       122      .308              3.958             444.84     1                     
  895       122      .308              3.958             444.84     1                     
  896       897       .05                .73              78.06     1                     
  897       808        0                 1.02             0       1.024                     
  898       848        0                 6.36             0         1.                      
  898      1047       .15                .89              1.6317    1                       
  933       895        .2               2.55             312.72     1                     
  933       955      .162               2.048             250.17    1                      
  933       959        .2                2.69             336.4     1                     
  934       933       .031               1.207             0      .9747         
  934      1047     3.045                15.738           27.123    1                       
  934      1047     3.041                15.718           27.089    1                       
  938       955     .2556                2.9224           360.4     1                     
  938       959     .127                 1.603            195.89    1                      
  939       938     .031                 1.15              0      .9586         
  939       938     .032                 1.163             0      .9586         
  939       938       0                   1.277            0      .9586         
  939      1015    1.271                  6.562            11.305   1                       
  939      1015    1.283                  6.564            11.522   1                        
  955       964    .1877                 2.3467            287.24   1                       
  959       895     .05                   .44              47.58    1                     
  960       834      2.21                11.475            19.687   1                        
  960       959    .032                  1.163              0     .9917         
  960       959    .031                  1.166              0     .9917         
  960      1015     1.892                9.776             16.845   1                        
  960      1015     1.895                9.704             17.029   1                        
  964       976     .0733                .9164             112.17   1                        
  965       964     .02                  1.211               0    .9717           
  965       964     .02                  1.233               0    .9717           
  976       995     .282                 3.852             493.7     1                    
  995       904       0                   1.1538             0       1.                    
  995       964     .1643                3.0339             354.88   1                      
  995      1030      .073                 .92               112.26   1                       
  995      1060      .172                 2.17              265.16   1                       
 1030       915       0                   2.0655              0      1.                     
 1030       955      .047                  .59               71.818  1                        
 1047       919       0                   1.7022              0      1.025                      
 1060       897      .076                 1.171              124.58  1                        
 1060       925       0                    1.515              0      1.024                     
 1210       976     .03                    1.219              0      1.01        
 1210       976     .039                   1.138              0      1.01        
 1210       976     .036                   1.217              0      1.01        
 1503      1504       0                     5.2               0       1.                      
 2458       896       0                     1.27              0      .9938          
 4501      4522      3.76                 20.68               35.66   1                        
 4501      4522      1.64                  12.46              61.5    1                       
 4521      4523       0                     20.71             0       1.
 4522      4521      1.53                   7.6               14.25   1                       
 4522      4532      3.25                  17.92              32.75   1                        
 4522      4532      3.25                  17.92              32.75   1                        
 4522      4623       0                      7.95             0       1.                      
 4522      4623       0                      7.95             0       1.                      
 4532      4530       0                      14.3             0       1.
 4532      4533       0                       8.6             0       1.                     
 4532      4533       0                       8.6             0       1.                      
 4532      4533       0                       8.6             0       1.                      
 4532      4542      1.62                    9.68            19.15    1                       
 4533      4596       0                      3.7635            0      1.
 4542      4552      1.83                   10.93              18.6   1                        
 4552      4572       1.4                     8.38              17.   1                        
 4562      4572       .94                    5.59              10.644 1                          
 4562      4582      1.24                     7.38             13.28  1                        
 4592        21        0                       6.4              0     1.
 4592      4542        1.                     6.17             12.6   1                        
 4623      4533     17.06                     45.5             11.39  1                         
 4703      4533        .9                     2.31             .58    1                       
 4703      4533        .9                     2.31             .58    1                       
 4805      4804        0                       13.333           0     1.                      
 4805      4807     3.089                     8.134            2.085  1                          
 4805      4807     3.089                     8.134            2.085  1                         
 4862      4532      2.57                     23.68            97.42  1                         
 4862      4532      2.57                     23.68            97.42  1                         
 4862      4807        0                      4.05             0      1.                      
];

for i = 1:size(DLIN,1)
    
    NOE       = DLIN(i,1);
    DLIN(i,1) = NOINT(NOE);     % Numero externo da barra i 
    
    NOE       = DLIN(i,2);
    DLIN(i,2) = NOINT(NOE);     % Numero externo da barra i 
end

DLIN(:,3) = DLIN(:,3)/100;
DLIN(:,4) = DLIN(:,4)/100;
DLIN(:,5) = (DLIN(:,5))/(2*PB);
DLIN(:,7) = zeros(171,1);
